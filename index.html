<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tout le Monde Chante Bébé Bou</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg: #121212;
      --surface: #181818;
      --surface2: #282828;
      --surface3: #333333;
      --accent: #e8a030;
      --accent2: #d4601a;
      --text: #ffffff;
      --text-sub: #b3b3b3;
      --text-muted: #727272;
      --radius: 8px;
    }

    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0 0 120px;
    }

    /* ── HEADER ── */
    .album-header {
      width: 100%;
      max-width: 900px;
      display: flex;
      align-items: flex-end;
      gap: 28px;
      padding: 48px 32px 28px;
      background: linear-gradient(180deg, #3d2810 0%, #1e1208 60%, var(--bg) 100%);
    }

    .album-cover {
      width: 200px;
      height: 200px;
      border-radius: 6px;
      box-shadow: 0 16px 48px rgba(0,0,0,.6);
      flex-shrink: 0;
      object-fit: cover;
    }

    .album-info { flex: 1; }
    .album-type { font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: .1em; margin-bottom: 6px; color: var(--text-sub); }
    .album-title { font-size: clamp(22px, 4vw, 42px); font-weight: 900; line-height: 1.1; margin-bottom: 10px; }
    .album-meta { font-size: 13px; color: var(--text-sub); }
    .album-meta span { color: var(--text); font-weight: 600; }

    /* ── CONTROLS BAR ── */
    .controls-bar {
      width: 100%;
      max-width: 900px;
      padding: 20px 32px 4px;
    }

    .controls-top {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 20px;
    }

    .btn-play-main {
      width: 56px; height: 56px;
      border-radius: 50%;
      background: var(--accent);
      border: none;
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0;
      transition: transform .1s, background .15s;
    }
    .btn-play-main:hover { background: #f0b040; transform: scale(1.05); }
    .btn-play-main svg { width: 22px; height: 22px; fill: #000; }

    .btn-icon {
      background: none; border: none; cursor: pointer;
      color: var(--text-sub);
      display: flex; align-items: center; justify-content: center;
      padding: 6px;
      border-radius: 50%;
      transition: color .15s;
    }
    .btn-icon:hover { color: var(--text); }
    .btn-icon svg { width: 20px; height: 20px; fill: currentColor; }
    .btn-icon.active { color: var(--accent); }

    /* ── TRACKLIST ── */
    .tracklist-header {
      width: 100%;
      max-width: 900px;
      padding: 0 32px;
      display: grid;
      grid-template-columns: 40px 1fr 80px;
      gap: 12px;
      border-bottom: 1px solid #282828;
      padding-bottom: 8px;
      margin-bottom: 4px;
    }
    .tracklist-header span {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: .1em;
      color: var(--text-muted);
    }
    .tracklist-header .th-dur { text-align: right; }

    .tracklist {
      width: 100%;
      max-width: 900px;
      padding: 0 32px;
    }

    .track-row {
      display: grid;
      grid-template-columns: 40px 1fr 80px;
      gap: 12px;
      align-items: center;
      padding: 8px 10px;
      border-radius: var(--radius);
      cursor: pointer;
      transition: background .12s;
      user-select: none;
    }
    .track-row:hover { background: var(--surface2); }
    .track-row.active { background: var(--surface2); }
    .track-row.active .track-num,
    .track-row.active .track-title { color: var(--accent); }

    .track-num {
      font-size: 14px;
      color: var(--text-muted);
      text-align: center;
      position: relative;
    }
    .track-row .play-icon { display: none; }
    .track-row:hover .num-text,
    .track-row.active .num-text { display: none; }
    .track-row:hover .play-icon,
    .track-row.active .play-icon { display: flex; align-items: center; justify-content: center; }
    .play-icon svg { width: 14px; height: 14px; fill: var(--text); }
    .track-row.active .play-icon svg { fill: var(--accent); }

    .track-info { overflow: hidden; }
    .track-title {
      font-size: 15px;
      font-weight: 500;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .track-artist {
      font-size: 13px;
      color: var(--text-sub);
      margin-top: 2px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .track-dur {
      font-size: 13px;
      color: var(--text-muted);
      text-align: right;
    }

    /* ── NOW PLAYING BAR (fixed bottom) ── */
    .now-playing-bar {
      position: fixed;
      bottom: 0; left: 0; right: 0;
      height: 90px;
      background: #0d0d0d;
      border-top: 1px solid #282828;
      display: flex;
      align-items: center;
      padding: 0 20px;
      gap: 16px;
      z-index: 100;
    }

    /* Left: current track info */
    .np-info {
      display: flex;
      align-items: center;
      gap: 12px;
      width: 280px;
      flex-shrink: 0;
    }
    .np-cover {
      width: 52px; height: 52px;
      border-radius: 4px;
      object-fit: cover;
      flex-shrink: 0;
    }
    .np-text { overflow: hidden; }
    .np-title {
      font-size: 13px;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .np-artist { font-size: 11px; color: var(--text-sub); margin-top: 2px; }

    /* Center: playback controls + progress */
    .np-center {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
    }

    .np-controls {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .np-btn {
      background: none; border: none; cursor: pointer;
      color: var(--text-sub);
      display: flex; align-items: center; justify-content: center;
      padding: 8px;
      border-radius: 50%;
      transition: color .15s, transform .1s;
    }
    .np-btn:hover { color: var(--text); transform: scale(1.1); }
    .np-btn svg { width: 18px; height: 18px; fill: currentColor; }
    .np-btn.big { padding: 6px; }
    .np-btn.big svg { width: 34px; height: 34px; }
    .np-btn.active { color: var(--accent); }

    /* Progress bar */
    .np-progress {
      width: 100%;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .time-label { font-size: 11px; color: var(--text-muted); width: 36px; text-align: center; }
    .progress-track {
      flex: 1;
      height: 4px;
      background: var(--surface3);
      border-radius: 2px;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }
    .progress-track:hover { height: 6px; }
    .progress-fill {
      height: 100%;
      background: var(--text);
      border-radius: 2px;
      width: 0%;
      transition: width .1s linear;
      pointer-events: none;
    }
    .progress-track:hover .progress-fill { background: var(--accent); }

    /* Right: volume */
    .np-volume {
      width: 180px;
      display: flex;
      align-items: center;
      gap: 8px;
      justify-content: flex-end;
      flex-shrink: 0;
    }
    .np-volume svg { width: 16px; height: 16px; fill: var(--text-sub); flex-shrink: 0; }
    .vol-slider {
      -webkit-appearance: none;
      width: 90px;
      height: 4px;
      background: var(--surface3);
      border-radius: 2px;
      outline: none;
      cursor: pointer;
    }
    .vol-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 12px; height: 12px;
      border-radius: 50%;
      background: var(--text);
      cursor: pointer;
      transition: background .15s;
    }
    .vol-slider:hover::-webkit-slider-thumb { background: var(--accent); }

    /* Animating equalizer icon */
    @keyframes eq1 { 0%,100%{height:6px}50%{height:14px} }
    @keyframes eq2 { 0%,100%{height:12px}50%{height:4px} }
    @keyframes eq3 { 0%,100%{height:8px}50%{height:16px} }
    .eq-anim {
      display: flex; align-items: flex-end; gap: 2px;
      height: 16px;
    }
    .eq-anim span {
      display: block; width: 3px; border-radius: 1px;
      background: var(--accent);
    }
    .eq-anim span:nth-child(1) { animation: eq1 .8s ease-in-out infinite; }
    .eq-anim span:nth-child(2) { animation: eq2 .7s ease-in-out infinite .1s; }
    .eq-anim span:nth-child(3) { animation: eq3 .9s ease-in-out infinite .2s; }
    .eq-anim.paused span { animation-play-state: paused; }

    @media (max-width: 600px) {
      .album-header { flex-direction: column; align-items: center; text-align: center; padding: 32px 16px 20px; }
      .album-cover { width: 160px; height: 160px; }
      .controls-bar, .tracklist, .tracklist-header { padding-left: 12px; padding-right: 12px; }
      .np-info { width: auto; flex: 1; }
      .np-volume { display: none; }
      .track-dur { display: none; }
      .tracklist-header .th-dur { display: none; }
    }
  </style>
</head>
<body>

<!-- ── ALBUM HEADER ── -->
<div class="album-header">
  <img class="album-cover" src="cover.jpg" alt="Pochette album" />
  <div class="album-info">
    <div class="album-type">Album</div>
    <div class="album-title">Tout le Monde Chante<br>Bébé Bou</div>
    <div class="album-meta">
      <span>15 titres</span> · by Davethepreacher · 2026
    </div>
  </div>
</div>

<!-- ── CONTROLS BAR ── -->
<div class="controls-bar">
  <div class="controls-top">
    <button class="btn-play-main" id="btnMainPlay" title="Lecture / Pause">
      <!-- Play icon -->
      <svg id="iconMainPlay" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
      <!-- Pause icon (hidden) -->
      <svg id="iconMainPause" viewBox="0 0 24 24" style="display:none"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
    </button>
    <button class="btn-icon" id="btnShuffle" title="Aléatoire">
      <svg viewBox="0 0 24 24"><path d="M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z"/></svg>
    </button>
    <button class="btn-icon" id="btnRepeat" title="Répéter">
      <svg viewBox="0 0 24 24"><path d="M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"/></svg>
    </button>
  </div>
</div>

<!-- ── TRACKLIST HEADER ── -->
<div class="tracklist-header">
  <span>#</span>
  <span>Titre</span>
  <span class="th-dur">Durée</span>
</div>

<!-- ── TRACKLIST ── -->
<div class="tracklist" id="tracklist"></div>

<!-- ── NOW PLAYING BAR ── -->
<div class="now-playing-bar">
  <!-- Left -->
  <div class="np-info">
    <img class="np-cover" id="npCover" src="cover.jpg" alt="" />
    <div class="np-text">
      <div class="np-title" id="npTitle">—</div>
      <div class="np-artist" id="npArtist">Sélectionnez un titre</div>
    </div>
  </div>

  <!-- Center -->
  <div class="np-center">
    <div class="np-controls">
      <button class="np-btn" id="btnPrev" title="Précédent">
        <svg viewBox="0 0 24 24"><path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/></svg>
      </button>
      <button class="np-btn big" id="btnPlay" title="Lecture / Pause">
        <svg id="iconPlay" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 14.5v-9l6 4.5-6 4.5z"/></svg>
        <svg id="iconPause" viewBox="0 0 24 24" style="display:none"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9V8h2v8zm4 0h-2V8h2v8z"/></svg>
      </button>
      <button class="np-btn" id="btnNext" title="Suivant">
        <svg viewBox="0 0 24 24"><path d="M6 18l8.5-6L6 6v12zm2-8.14L11.03 12 8 14.14V9.86zM16 6h2v12h-2z"/></svg>
      </button>
    </div>
    <div class="np-progress">
      <span class="time-label" id="timeCurrent">0:00</span>
      <div class="progress-track" id="progressTrack">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <span class="time-label" id="timeDuration">0:00</span>
    </div>
  </div>

  <!-- Right: volume -->
  <div class="np-volume">
    <svg viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>
    <input type="range" class="vol-slider" id="volSlider" min="0" max="1" step="0.01" value="1" />
  </div>
</div>

<audio id="audioPlayer"></audio>

<script>
const tracks = [
  { num: 1,  file: "TRAX/01_Enrico Macias_Sous le Soleid d'Algérie.mp3",  title: "Sous le Soleil d'Algérie",     artist: "Enrico Macias" },
  { num: 2,  file: "TRAX/02_Dalida_Danse avec moi.mp3",                   title: "Danse avec moi",               artist: "Dalida" },
  { num: 3,  file: "TRAX/03_Aznavour - Petit Bout d'Amour.mp3",           title: "Petit Bout d'Amour",           artist: "Charles Aznavour" },
  { num: 4,  file: "TRAX/04_Claude François -  Danse avec moi Caroline.mp3", title: "Danse avec moi Caroline",  artist: "Claude François" },
  { num: 5,  file: "TRAX/05_Edith Piaf - De tout mon coeur.mp3",          title: "De tout mon cœur",             artist: "Édith Piaf" },
  { num: 6,  file: "TRAX/06_Michel Berger - Ma douce Caroline.mp3",       title: "Ma douce Caroline",            artist: "Michel Berger" },
  { num: 7,  file: "TRAX/07_Jacques Brel - Viens voir le Bébé Bou.mp3",   title: "Viens voir le Bébé Bou",      artist: "Jacques Brel" },
  { num: 8,  file: "TRAX/08_Polnareff_Precieuse Caroline.mp3",            title: "Précieuse Caroline",           artist: "Michel Polnareff" },
  { num: 9,  file: "TRAX/09_Gaisnbourg - Bébé Bou d'amour.mp3",          title: "Bébé Bou d'amour",             artist: "Serge Gainsbourg" },
  { num: 10, file: "TRAX/10_France Gall-Toi ma Caroline.mp3",             title: "Toi ma Caroline",              artist: "France Gall" },
  { num: 11, file: "TRAX/11_Jane Berkin Bout d'amour.mp3",                title: "Bout d'amour",                 artist: "Jane Birkin" },
  { num: 12, file: "TRAX/12_Johnny Halliday - Caroline mon feu.mp3",      title: "Caroline mon feu",             artist: "Johnny Hallyday" },
  { num: 13, file: "TRAX/13_Jacques Dutrounc - Petit Bout.mp3",           title: "Petit Bout",                   artist: "Jacques Dutronc" },
  { num: 14, file: "TRAX/14_Patrick Bruel - J'ai rencontré Caroline.mp3", title: "J'ai rencontré Caroline",      artist: "Patrick Bruel" },
  { num: 15, file: "TRAX/15_Mylène Farmer - Amour de Soie.mp3",           title: "Amour de Soie",                artist: "Mylène Farmer" },
];

// ── STATE ──────────────────────────────────────────────
let currentIndex = -1;
let isPlaying = false;
let isShuffle = false;
let isRepeat  = false;  // 0=off, 1=all, 2=one
let repeatMode = 0;

const audio       = document.getElementById('audioPlayer');
const btnPlay     = document.getElementById('btnPlay');
const btnMainPlay = document.getElementById('btnMainPlay');
const btnPrev     = document.getElementById('btnPrev');
const btnNext     = document.getElementById('btnNext');
const btnShuffle  = document.getElementById('btnShuffle');
const btnRepeat   = document.getElementById('btnRepeat');
const iconPlay    = document.getElementById('iconPlay');
const iconPause   = document.getElementById('iconPause');
const iconMainPlay  = document.getElementById('iconMainPlay');
const iconMainPause = document.getElementById('iconMainPause');
const progressTrack = document.getElementById('progressTrack');
const progressFill  = document.getElementById('progressFill');
const timeCurrent   = document.getElementById('timeCurrent');
const timeDuration  = document.getElementById('timeDuration');
const npTitle  = document.getElementById('npTitle');
const npArtist = document.getElementById('npArtist');
const volSlider = document.getElementById('volSlider');
const tracklist = document.getElementById('tracklist');

// ── BUILD TRACKLIST ────────────────────────────────────
tracks.forEach((t, i) => {
  const row = document.createElement('div');
  row.className = 'track-row';
  row.dataset.index = i;
  row.innerHTML = `
    <div class="track-num">
      <span class="num-text">${t.num}</span>
      <span class="play-icon">
        <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
      </span>
    </div>
    <div class="track-info">
      <div class="track-title">${t.title}</div>
      <div class="track-artist">${t.artist}</div>
    </div>
    <div class="track-dur" id="dur-${i}">—</div>
  `;
  row.addEventListener('click', () => {
    if (currentIndex === i) { togglePlay(); }
    else { loadTrack(i, true); }
  });
  tracklist.appendChild(row);
});

// ── LOAD DURATION ──────────────────────────────────────
tracks.forEach((t, i) => {
  const tmp = new Audio();
  tmp.src = t.file;
  tmp.addEventListener('loadedmetadata', () => {
    const el = document.getElementById(`dur-${i}`);
    if (el) el.textContent = fmtTime(tmp.duration);
  });
});

// ── HELPERS ───────────────────────────────────────────
function fmtTime(s) {
  if (!isFinite(s)) return '—';
  const m = Math.floor(s / 60);
  const sec = Math.floor(s % 60);
  return `${m}:${sec.toString().padStart(2,'0')}`;
}

function setPlayIcons(playing) {
  iconPlay.style.display  = playing ? 'none' : '';
  iconPause.style.display = playing ? '' : 'none';
  iconMainPlay.style.display  = playing ? 'none' : '';
  iconMainPause.style.display = playing ? '' : 'none';
}

function updateActiveRow() {
  document.querySelectorAll('.track-row').forEach((r, i) => {
    r.classList.toggle('active', i === currentIndex);
    // Swap icon: playing animation vs static play arrow
    const numText = r.querySelector('.num-text');
    const playIcon = r.querySelector('.play-icon');
    if (i === currentIndex && isPlaying) {
      // Show eq animation in num cell
      numText.innerHTML = `<div class="eq-anim"><span></span><span></span><span></span></div>`;
    } else {
      numText.innerHTML = tracks[i].num;
    }
  });
}

function loadTrack(index, autoplay = false) {
  currentIndex = index;
  const t = tracks[index];
  audio.src = t.file;
  npTitle.textContent  = t.title;
  npArtist.textContent = t.artist;
  timeDuration.textContent = '—';
  progressFill.style.width = '0%';
  timeCurrent.textContent = '0:00';
  if (autoplay) {
    audio.play().then(() => {
      isPlaying = true;
      setPlayIcons(true);
      updateActiveRow();
    }).catch(() => {});
  } else {
    isPlaying = false;
    setPlayIcons(false);
    updateActiveRow();
  }
}

function togglePlay() {
  if (currentIndex < 0) { loadTrack(0, true); return; }
  if (isPlaying) {
    audio.pause();
    isPlaying = false;
  } else {
    audio.play().then(() => { isPlaying = true; }).catch(() => {});
  }
  setPlayIcons(isPlaying);
  updateActiveRow();
}

function playNext() {
  if (repeatMode === 2) { audio.currentTime = 0; audio.play(); return; }
  let next;
  if (isShuffle) {
    do { next = Math.floor(Math.random() * tracks.length); } while (next === currentIndex && tracks.length > 1);
  } else {
    next = (currentIndex + 1) % tracks.length;
  }
  loadTrack(next, true);
}

function playPrev() {
  if (audio.currentTime > 3) { audio.currentTime = 0; return; }
  const prev = (currentIndex - 1 + tracks.length) % tracks.length;
  loadTrack(prev, true);
}

// ── EVENTS ────────────────────────────────────────────
btnPlay.addEventListener('click',     togglePlay);
btnMainPlay.addEventListener('click', togglePlay);
btnNext.addEventListener('click',     playNext);
btnPrev.addEventListener('click',     playPrev);

btnShuffle.addEventListener('click', () => {
  isShuffle = !isShuffle;
  btnShuffle.classList.toggle('active', isShuffle);
});

btnRepeat.addEventListener('click', () => {
  repeatMode = (repeatMode + 1) % 3;
  btnRepeat.classList.toggle('active', repeatMode > 0);
  // Visual cue for repeat-one: add small "1" overlay (simple approach)
  btnRepeat.title = ['Répéter', 'Répéter tout', 'Répéter ce titre'][repeatMode];
});

audio.addEventListener('timeupdate', () => {
  if (!isFinite(audio.duration)) return;
  const pct = (audio.currentTime / audio.duration) * 100;
  progressFill.style.width = pct + '%';
  timeCurrent.textContent  = fmtTime(audio.currentTime);
});

audio.addEventListener('loadedmetadata', () => {
  timeDuration.textContent = fmtTime(audio.duration);
});

audio.addEventListener('ended', () => {
  if (repeatMode === 2) { audio.play(); return; }
  if (repeatMode === 1 || currentIndex < tracks.length - 1) { playNext(); }
  else { isPlaying = false; setPlayIcons(false); updateActiveRow(); }
});

audio.addEventListener('play',  () => { isPlaying = true;  setPlayIcons(true);  updateActiveRow(); });
audio.addEventListener('pause', () => { isPlaying = false; setPlayIcons(false); updateActiveRow(); });

// Progress bar click / drag
progressTrack.addEventListener('click', (e) => {
  if (!isFinite(audio.duration)) return;
  const rect = progressTrack.getBoundingClientRect();
  const pct  = (e.clientX - rect.left) / rect.width;
  audio.currentTime = pct * audio.duration;
});

// Volume
volSlider.addEventListener('input', () => { audio.volume = volSlider.value; });

// ── KEYBOARD ──────────────────────────────────────────
document.addEventListener('keydown', (e) => {
  if (e.target.tagName === 'INPUT') return;
  if (e.code === 'Space')      { e.preventDefault(); togglePlay(); }
  if (e.code === 'ArrowRight') { e.preventDefault(); audio.currentTime = Math.min(audio.duration, audio.currentTime + 10); }
  if (e.code === 'ArrowLeft')  { e.preventDefault(); audio.currentTime = Math.max(0, audio.currentTime - 10); }
  if (e.code === 'ArrowUp')    { e.preventDefault(); volSlider.value = Math.min(1, +volSlider.value + .1); audio.volume = volSlider.value; }
  if (e.code === 'ArrowDown')  { e.preventDefault(); volSlider.value = Math.max(0, +volSlider.value - .1); audio.volume = volSlider.value; }
});
</script>
</body>
</html>
